@using Platform.Trading.Management.Models
@inject DialogService DialogService

<RadzenStack Gap="1rem">
    <RadzenFieldset Text="Monthly Report Details">
        <RadzenStack Gap="1rem">
            <RadzenRow>
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenFormField Text="Report Number" Variant="Variant.Outlined">
                        <RadzenTextBox @bind-Value="Report.ReportNumber" Style="width: 100%;" Disabled="true" />
                    </RadzenFormField>
                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenFormField Text="Report Month" Variant="Variant.Outlined">
                        <RadzenDatePicker @bind-Value="Report.ReportMonth" DateFormat="MM/yyyy" View="CalendarView.Year" Style="width: 100%;" ShowTime="false" />
                    </RadzenFormField>
                </RadzenColumn>
            </RadzenRow>
            <RadzenRow>
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenFormField Text="Total Trades Processed" Variant="Variant.Outlined">
                        <RadzenNumeric @bind-Value="Report.TotalTradesProcessed" Style="width: 100%;" />
                    </RadzenFormField>
                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenFormField Text="Total Quantity Traded (MT)" Variant="Variant.Outlined">
                        <RadzenNumeric @bind-Value="Report.TotalQuantityTraded" Style="width: 100%;" Format="N0" />
                    </RadzenFormField>
                </RadzenColumn>
            </RadzenRow>
            <RadzenRow>
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenFormField Text="Total Value Traded" Variant="Variant.Outlined">
                        <RadzenNumeric @bind-Value="Report.TotalValueTraded" Style="width: 100%;" Format="c0" />
                    </RadzenFormField>
                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenFormField Text="New Buyers Registered" Variant="Variant.Outlined">
                        <RadzenNumeric @bind-Value="Report.NewBuyersRegistered" Style="width: 100%;" />
                    </RadzenFormField>
                </RadzenColumn>
            </RadzenRow>
            <RadzenRow>
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenFormField Text="New Sellers Registered" Variant="Variant.Outlined">
                        <RadzenNumeric @bind-Value="Report.NewSellersRegistered" Style="width: 100%;" />
                    </RadzenFormField>
                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenFormField Text="Inspections Conducted" Variant="Variant.Outlined">
                        <RadzenNumeric @bind-Value="Report.InspectionsConducted" Style="width: 100%;" />
                    </RadzenFormField>
                </RadzenColumn>
            </RadzenRow>
            <RadzenRow>
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenFormField Text="Compliance Rate (%)" Variant="Variant.Outlined">
                        <RadzenNumeric @bind-Value="Report.ComplianceRate" Style="width: 100%;" Format="N1" Min="0" Max="100" />
                    </RadzenFormField>
                </RadzenColumn>
                <RadzenColumn Size="12" SizeMD="6">
                    <RadzenFormField Text="Status" Variant="Variant.Outlined">
                        <RadzenDropDown @bind-Value="Report.Status" Data="@statusOptions" Style="width: 100%;" />
                    </RadzenFormField>
                </RadzenColumn>
            </RadzenRow>
            <RadzenRow>
                <RadzenColumn Size="12">
                    <RadzenFormField Text="Summary" Variant="Variant.Outlined">
                        <RadzenTextArea @bind-Value="Report.Summary" Style="width: 100%;" Rows="3" />
                    </RadzenFormField>
                </RadzenColumn>
            </RadzenRow>
        </RadzenStack>
    </RadzenFieldset>

    <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.End" Gap="0.5rem">
        <RadzenButton Text="Cancel" ButtonStyle="ButtonStyle.Light" Click="Cancel" />
        <RadzenButton Text="Save" ButtonStyle="ButtonStyle.Primary" Click="Save" />
    </RadzenStack>
</RadzenStack>

@code {
    [Parameter]
    public MonthlyProcessingReport Report { get; set; } = new();

    private string[] statusOptions = new[] { "Draft", "Finalized", "Approved" };

    private void Save()
    {
        DialogService.Close(Report);
    }

    private void Cancel()
    {
        DialogService.Close(null);
    }
}
