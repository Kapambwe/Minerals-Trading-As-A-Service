@page "/minerals"
@using MiningTradingClientApp.Models
@using MiningTradingClientApp.Services
@using System.Linq
@inject IMineralService MineralService

<PageTitle>Available Minerals</PageTitle>

<div class="page-container">
    <h1>Available Minerals</h1>

    @if (minerals == null || !minerals.Any())
    {
        <div class="info-message">
            <em>Loading minerals or no minerals available...</em>
        </div>
    }
    else
    {
        <div class="card-container">
            @foreach (var mineral in minerals)
            {
                <div class="card">
                    <img src="@mineral.ImageUrl" class="card-image" alt="@mineral.Name">
                    <div class="card-body">
                        <h5 class="card-title">@mineral.Name
                            @if (mineral.IsVerified)
                            {
                                <span class="verified-badge">Verified</span>
                            }
                        </h5>
                        <p class="card-text">@mineral.Description</p>
                        <ul class="card-details-list">
                            <li>
                                <span>Price:</span>
                                <strong>@mineral.Price.ToString("C")</strong>
                            </li>
                            <li>
                                <span>Weight:</span>
                                <span>@mineral.Weight kg</span>
                            </li>
                            <li>
                                <span>Origin:</span>
                                <span>@mineral.Origin</span>
                            </li>
                            <li>
                                <span>Seller:</span>
                                <span>@mineral.Seller</span>
                            </li>
                            <li>
                                <span>Listed:</span>
                                <span>@mineral.DateListed.ToShortDateString()</span>
                            </li>
                        </ul>
                        <div class="card-actions">
                            <a href="/order/@mineral.Id" class="btn btn-primary">Buy Now</a>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>

@code {
    private IEnumerable<Mineral> minerals = Enumerable.Empty<Mineral>();

    protected override async Task OnInitializedAsync()
    {
        minerals = await MineralService.GetAvailableMineralsAsync();
    }
}